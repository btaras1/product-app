<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="ISO-8859-1" />
    <title>Product management app</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
    />
    <link th:href="@{/styles/main.css}" rel="stylesheet" />
  </head>
  <body>
    <div class="container-wrapper">
      <div class="text-center mb-4">
        <h1 class="fixed-header">Product List</h1>
      </div>
      <div class="container my-2">
        <a
          th:href="@{/product/add}"
          class="btn btn-primary btn-sm mb-3 fixed-header"
          >Add Product</a
        >
        <div class="table-container">
          <table border="1" class="table table-striped table-responsive-md">
            <thead>
              <tr>
                <th>
                  <a
                    th:href="@{'/product/page/' + ${currentPage} + '?sortField=name&sortDir=' + ${reverseSortDir}} + '&pageSize=' + ${pageSize}"
                  >
                    Product Name
                  </a>
                </th>
                <th>
                  <a
                    th:href="@{'/product/page/' + ${currentPage} + '?sortField=code&sortDir=' + ${reverseSortDir}} + '&pageSize=' + ${pageSize}"
                  >
                    Product Code
                  </a>
                </th>
                <th>
                  <a
                    th:href="@{'/product/page/' + ${currentPage} + '?sortField=priceEur&sortDir=' + ${reverseSortDir}} + '&pageSize=' + ${pageSize}"
                  >
                    Product price (EUR)
                  </a>
                </th>
                <th>
                  <a
                    th:href="@{'/product/page/' + ${currentPage} + '?sortField=priceUsd&sortDir=' + ${reverseSortDir}} + '&pageSize=' + ${pageSize}"
                  >
                    Product price (USD)
                  </a>
                </th>
                <th>
                  <a
                    th:href="@{'/product/page/' + ${currentPage} + '?sortField=isAvailable&sortDir=' + ${reverseSortDir}} + '&pageSize=' + ${pageSize}"
                  >
                    Is available
                  </a>
                </th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr th:each="product : ${productList}">
                <td th:text="${product.name}"></td>
                <td th:text="${product.code}"></td>
                <td th:text="${product.priceEur}"></td>
                <td th:text="${product.priceUsd}"></td>
                <td th:text="${product.available} ? 'Yes' : 'No'"></td>
                <td>
                  <a
                    th:href="@{/product/details/{id}(id=${product.id})}"
                    class="btn btn-danger"
                    >View</a
                  >
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div th:if="${totalPages > 1}">
          <div class="row col-sm-10">
            <div class="col-sm-5">Total number of products: [[${totalItems}]]</div>
            <div class="col-sm-3">
              <span th:each="i: ${#numbers.sequence(1, totalPages)}">
                <a
                  th:if="${currentPage != i}"
                  th:href="@{'/product/page/' + ${i} + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir}} + '&pageSize=' + ${pageSize}"
                  >[[${i}]]</a
                >
                <span th:unless="${currentPage != i}">[[${i}]]</span>
              </span>
            </div>
            <div class="col-sm-1">
              <a
                th:if="${currentPage > 1}"
                th:href="@{'/product/page/' + ${currentPage - 1} + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir}} + '&pageSize=' + ${pageSize}"
                >Back</a
              >
              <span th:unless="${currentPage > 1}">Back</span>
            </div>
            <div class="col-sm-1">
              <a
                th:if="${currentPage < totalPages}"
                th:href="@{'/product/page/' + ${currentPage + 1} + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir}} + '&pageSize=' + ${pageSize}"
                >Next</a
              >
              <span th:unless="${currentPage < totalPages}">Next</span>
            </div>
            <div class="col-sm-2">
              <form
                th:action="@{'/product/page/' + ${currentPage}}"
                method="get"
              >
                <input type="hidden" name="sortField" th:value="${sortField}" />
                <input type="hidden" name="sortDir" th:value="${sortDir}" />
                <select
                  name="pageSize"
                  class="form-control form-control-sm"
                  onchange="this.form.submit()"
                >
                  <option
                    th:each="size : ${pageSizeList}"
                    th:value="${size}"
                    th:text="${size}"
                    th:selected="${size == pageSize}"
                  ></option>
                </select>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
